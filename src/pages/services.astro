---
// Page Services - Jon Labs
// Expérience interactive avec caméléon mascotte, bulles de scénarios, et conversations animées

import "../styles/global.css";
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import HeroScenarios from "../components/services/HeroScenarios.astro";
import ConversationModal from "../components/services/ConversationModal.astro";
import ServiceSection from "../components/services/ServiceSection.astro";
import ServicesCTA from "../components/services/ServicesCTA.astro";
import { services } from "../sample";

// Schema.org
import { servicesListData, SITE_URL } from '../data/schema';
import { getWebPageSchema } from '../lib/seo';

const pageTitle = "Services - Jon Labs | Développement Web, Automatisation, Applications";
const pageDescription = "Découvrez comment Jon Labs peut résoudre vos problématiques business. Développement web, automatisation des processus, et applications sur-mesure. Explorez les solutions adaptées à votre situation.";

const webPageSchema = getWebPageSchema({
  url: `${SITE_URL}/services`,
  name: pageTitle,
  description: pageDescription
});

const schemas = [servicesListData, webPageSchema];
---

<Layout
  title={pageTitle}
  description={pageDescription}
  schemas={schemas}
>
  <Header variant="transparent" scrollTransition={true} />

  <main>
    <!-- Section Hero avec caméléon et bulles constellation -->
    <HeroScenarios />

    <!-- Section Services Détaillés -->
    <section class="services-detail" id="services-detail">
      <div class="services-container">
        <header class="section-header">
          <div class="header-content">
            <div>
              <h2 class="section-title">
                Mes services<br />
                en détail
              </h2>
            </div>
            <div>
              <a href="/contact" class="section-cta">
                Me contacter
                <i class="ri-arrow-right-line"></i>
              </a>
            </div>
          </div>
        </header>

        <div class="services-grid">
          <ServiceSection sectionId="web-outils" />
          <ServiceSection sectionId="automatisation" />
          <ServiceSection sectionId="validation" />
        </div>
      </div>
    </section>

    <!-- CTA Final -->
    <ServicesCTA />
  </main>

  <!-- Modal pour les conversations -->
  <ConversationModal />

  <Footer />
</Layout>

<style>
  /* Section Services Detail */
  .services-detail {
    padding: 5rem 1rem;
    background: white;
    border-top: 3px solid black;
  }

  .services-container {
    max-width: 900px;
    margin: 0 auto;
  }

  /* Section Header - Style Homepage */
  .section-header {
    position: relative;
    margin-bottom: 4rem;
  }

  .header-content {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  @media (min-width: 768px) {
    .header-content {
      flex-direction: row;
      align-items: flex-end;
      justify-content: space-between;
    }
  }

  .section-title {
    font-size: clamp(2rem, 5vw, 3rem);
    font-weight: 400;
    margin: 0;
    line-height: 0.95;
    letter-spacing: -0.02em;
  }

  .section-cta {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--text, #0f172a);
    text-decoration: none;
    border-bottom: 2px solid black;
    padding-bottom: 0.25rem;
    transition: all 0.2s ease;
  }

  .section-cta:hover {
    gap: 0.75rem;
    border-color: var(--blue, #00d9a3);
  }

  /* Services Grid */
  .services-grid {
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .services-detail {
      padding: 3rem 1rem;
    }

    .section-header {
      margin-bottom: 2.5rem;
    }

    .services-grid {
      gap: 2rem;
    }
  }
</style>

<script>
  // Animation d'entrée au scroll pour les services
  const observerOptions = {
    threshold: 0.1,
    rootMargin: "0px 0px -50px 0px",
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add("visible");
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  // Observer les catégories de services
  document.querySelectorAll(".service-category").forEach((el) => {
    el.classList.add("animate-on-scroll");
    observer.observe(el);
  });
</script>

<style is:global>
  /* Background sombre pour la page services (header transparent) */
  body {
    background-color: #0a0a0f;
  }

  /* Animation au scroll */
  .animate-on-scroll {
    opacity: 0;
    transform: translateY(30px);
    transition:
      opacity 0.6s ease-out,
      transform 0.6s ease-out;
  }

  .animate-on-scroll.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Échelonnement des services */
  .service-category:nth-child(1).animate-on-scroll {
    transition-delay: 0s;
  }

  .service-category:nth-child(2).animate-on-scroll {
    transition-delay: 0.15s;
  }

  .service-category:nth-child(3).animate-on-scroll {
    transition-delay: 0.3s;
  }
</style>
